<!doctype html>
<html lang="en">

<!--
    Название
Haskell для питониста.
Сравнение функциональных подходов в Haskell и Python.

    Целевая аудитория
Изучающие функциональное программирование;
разработчики на Haskell и Python.

    Тезисы:
Будущее программирования и функциональные языки.
Лёгкость обучения функциональному языку при императивном бэкграунде.
Функциональные аналоги императивных управляющих структур.
Преимущества функционального подхода.
Эффективная обработка ошибок.

    Коротко о вас
Разработчик в Яндексе, функциональный энтузиаст, преподаватель ФП в школе.
-->

    <head>
        <meta charset="utf-8">

        <title>Python 5</title>

        <meta name="description" content="">
        <meta name="author" content="Yuriy Syrovetskiy">

        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

        <link rel="stylesheet" href="css/reveal.css">
        <link rel="stylesheet" href="css/theme/yandex.css" id="theme">

        <style type="text/css">
            code {
                padding-top:    0 !important;
                padding-bottom: 0 !important;
            }
            code.emphasis {
                background: #ffcc00 !important;
            }
            code.error, code.error span {
                color: red !important;
                font-weight: bold;
            }
            h2, h3, h4, h5, h6 {
                text-align: center;
            }
            pre {
                box-shadow:     none  !important;
                margin-top:     0     !important;
                margin-bottom:  0     !important;
            }
            table {
                margin: 0 !important;
                width:  100%;
            }
        </style>

        <!-- Code syntax highlighting -->
        <link rel="stylesheet" href="lib/css/default.css">

        <!-- Printing and PDF exports -->
        <script>
            var link = document.createElement( 'link' );
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
            document.getElementsByTagName( 'head' )[0].appendChild( link );
        </script>

        <!--[if lt IE 9]>
        <script src="lib/js/html5shiv.js"></script>
        <![endif]-->
    </head>

    <body>

        <div class="reveal">

            <!-- Any section element inside of this container is displayed as a slide -->
            <div class="slides">
                <section>
                    <div class="yandexlogo yandexlogo-big"></div>
                </section>

                <section>
                    <div class="titleslide">
                        <p class="yandexlogo"></p>
                        <h1>Now is better<br> than never</h1>
                        <p>Юрий Сыровецкий,<br> питонист</p>
                    </div>

                    <aside class="notes">
                        Привет.
                        Меня зовут Юра, я работаю в Яндексе,
                        и разрабатываю на Питоне.
                        В анонсе я написал, что хочу рассказать о том,
                        как выглядит Хаскелл глазами питониста,
                        но сегодня я вдруг передумал и решил,
                        что лучше расскажу вам про...
                    </aside>
                </section>

                <section>
                    <h1>
                        &nbsp; Python

                        <aside class="notes">
                            ...Питон.

                            Как-то подходит ко мне Гвидо наш ван Россум
                            и говорит:
                            У Питона, говорит, дела плохи.
                            Двойка уже безнадёжно устрела,
                            в Тройку ещё никто не верит.
                            Новички плюются, профи плачут.
                            Надо что-то радикально менять.

                            Я сразу проснулся и решил: да! надо менять.
                            Надо создать новый Питон,
                            свободный от грехов прошлого.
                            Идеальный язык двадцать первого века!
                            Назовём его, скажем...

                            ...Питон 5.

                            Ну, по аналогии с Перлом 8.
                        </aside>

                        <span class="fragment" style="font-size: 130%">5</span>
                    </h1>
                </section>

                <section>
                    <h2>Совместимость</h2>

                    <aside class="notes">
                        Прежде всего, стоит сказать о совместимости.
                    </aside>

                    <p> Уважая традиции<span class="fragment">,<br>
                            ломаем совместимость<br>
                            во имя прогресса!
                        </span>
                    </p>
                </section>

                <section>
                    <h2>Как определить константу?</h2>
                    <pre><code class="python fragment">
    MAGIC = 42
                    </code></pre>
                </section>

                <section>
                    <pre><code class="python">
    monkey.patch()
                    </code></pre>
                </section>

                <section>
                    <h2>Изменяемое и неизменяемое</h2>
                    <table>
                        <tr>
                            <td>
                                <h3>Python 3</h3>
                                <pre><code>
  numbers = [2, 4, 6, 8]
  product = 1
  for n in numbers:
      product *= n
  print("The product is",
        product)
  </code> <code>
  The product is 384
  </code></pre>
                            </td>
                            <td class="fragment">
                                <h3>Python 5</h3>
                                <pre><code>
  numbers = [2, 4, 6, 8]</code><code class="emphasis">  product &lt;- 1</code><code>  for n in numbers:
      product *= n
  print("The product is",
        product)
  </code> <code>
  The product is 384
  </code></pre>
                            </td>
                        </tr>
                    </table>
                </section>

                <section>
                    <h2>Блоки и лямбды</h2>
                    <table>
                        <tr>
                            <td>
                                <h3>Python 3</h3>
                                <pre><code>
  numbers = [2, 4, 6, 8]
  product = 1
  for n in numbers:
      product *= n
  print("The product is",
        product)
  </code> <code>
  The product is 384
  </code></pre>
                            </td>
                            <td>
                                <h3>Python 5</h3>
                                <pre><code>
  numbers = [2, 4, 6, 8]
  product &lt;- 1</code><code class="python emphasis">  for numbers: n -></code><code>      product *= n
  print("The product is",
        product)
  </code> <code>
  The product is 384
  </code></pre>
                            </td>
                        </tr>
                    </table>
                </section>

                <section>
                    <h2>Многострочные лямбды!</h2>
                    <pre><code>
    for numbers: n ->
        print("Current sub-product is", product)
        product *= n
                    </code></pre>
                </section>

                <section>
                    <img src="morpheus-with.jpg" alt="ЧТО ЕСЛИ Я СКАЖУ, ЧТО WITH НЕ НУЖЕН?">
                </section>

                <section>
                    <h2>Лямбды как блоки</h2>
                    <table>
                        <tr>
                            <td width="50%">
                                <h3>Python 3</h3>
                                <pre><code>
  def example1():
      with context():
          foo()
          bar()
  </code> <code class="fragment">
  def example2():
      @retry(n)
      def _():
          foo()
          bar()
  </code></pre>
                            </td>
                            <td class="fragment" width="50%">
                                <h3>Python 5</h3>
                                <pre><code>
  def example1():
      context():
          foo()
          bar()
  </code> <code class="fragment">
  def example2():
      retry(n):
          foo()
          bar()
  </code></pre>
                            </td>
                        </tr>
                    </table>
                </section>

                <section>
                    <table>
                        <tr>
                            <td>
                                <h3>Python 3</h3>
                                <pre><code>
  >>> adders = [
  ...     lambda x: x + i
  ...     for i in range(3)
  ... ]

  >>> [f(0) for f in adders]
  </code><code class="fragment python">  [2, 2, 2]
  </code></pre>
                            </td>
                            <td class="fragment">
                                <h3>Python 5</h3>
                                <pre><code class="python">
  >>> adders = [
  ...     x -> x + i
  ...     for i in range(3)
  ... ]

  >>> [f(0) for f in adders]

  [0, 1, 2]
  </code></pre>
                            </td>
                        </tr>
                    </table>
                </section>

                <section>
                    <h2>Статическая типизация</h2>
                    <p>Найди ошибку до того, как ошибка найдёт тебя!</p>
                </section>

                <section>
                    <img src="duck.jpg" alt="Duck">
                </section>

                <section>
                    <pre><code class="haskell">
    JavaRDD&lt;String> file = spark.textFile("hdfs://...");
    JavaRDD&lt;String> words = file.flatMap(
        new FlatMapFunction&lt;String, String>() {
            public Iterable&lt;String> call(String s) {
                return Arrays.asList(s.split(" "));
            }
        }
    );
    JavaPairRDD&lt;String, Integer> pairs = words.mapToPair(
        new PairFunction&lt;String, String, Integer>() {
            public Tuple2&lt;String, Integer> call(String s) {
                return new Tuple2&lt;String, Integer>(s, 1);
            }
        }
    );
    JavaPairRDD&lt;String, Integer> counts = pairs.reduceByKey(
        new Function2&lt;Integer, Integer>() {
            public Integer call(Integer a, Integer b) {
                return a + b;
            }
        }
    );
    counts.saveAsTextFile("hdfs://...");
                    </code></pre>
                </section>

                <section>
                    <pre><code class="python">
    file = spark.textFile("hdfs://...")
    words = file.flatMap(s -> s.split(" "))
    pairs = words.mapToPair(s -> (s, 1))
    counts = pairs.reduceByKey((a, b) -> a + b)
    counts.saveAsTextFile("hdfs://...")
                    </code></pre>
                </section>

                <section>
                    <pre><code class="python">
    file = spark.textFile("hdfs://...")
    counts = (file.flatMap(s -> s.split(" "))
                  .mapToPair(s -> (s, 1))
                  .reduceByKey((a, b) -> a + b))
    counts.saveAsTextFile("hdfs://...")
                    </code></pre>
                </section>

                <section>
                    <h2>Ненавязчивая статическая типизация</h2>
                    <pre>
                    <code class="haskell">
    distance((x1, y1), (x2, y2)) =
        sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2)
                    </code></pre>
                </section>

                <section>
                    <h2>Ненавязчивая статическая типизация</h2>
                    <pre><code class="haskell">
    distance :: ((Float, Float), (Float, Float)) -> Float
    distance((x1, y1), (x2, y2)) =
        sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2)
                    </code></pre>
                </section>

                <section>
                    <pre><code>
    class Color(Enum):
        Red
        Green
        Blue

    def html_code(Red):   "#ff0000"
    def html_code(Green): "#00ff00"</code><code class="fragment error"> Error: html_code(Blue) is not defined</code>
<code>
    print(html_code("Green"))</code><code class="error"> Error: Couldn't match expected type ‘Color’
                    with actual type ‘str’
                    </code></pre>
                    <p class="fragment">Рефакторинг без боли!</p>
                </section>

                <section>
                    <h2>HTML и шаблонизация</h2>
                    <pre><code>
    Welcome to {{ eventname }}!
                    </code></pre>
                    <div class="fragment">
                        <blockquote>
                            Welcome to !
                        </blockquote>
                        (jinja2)
                    </div>
                </section>

                <section>
                    <pre><code>
    print("Welcome to {eventname}!"
          .format(event="Python&amp;Admin Party"))
    </code> <code>
    Traceback (most recent call last):
      ...
    KeyError: 'eventname'
                    </code></pre>
                </section>

                <section>
                    <pre><code>
    Welcome to {{ eventname }}!
                    </code> <code class="fragment">
    "Welcome to " + to_html(eventname) + "!"
                    </code></pre>
                    <ul class="fragment">
                        <li><code>str</code> — <code>html_escape</code></li>
                        <li><code>Markdown</code> — <code>render_markdown</code></li>
                        <li><code>HTML</code> — как есть</li>
                        <li><code>NoneType</code> — ошибка!</li>
                    </ul>
                </section>

                <section>
                    <h2>Статическая типизация ускоряет разработку</h2>
                </section>

                <section>
                    <h2>Инструменты: интерпретатор</h2>
                    <pre><code>
    $ ls
    hello.py

    $ python5 hello.py
    Hello world!
                    </code></pre>
                    <p class="fragment">Невалидная программа не запустится</p>
                </section>

                <section>
                    <h2>Инструменты: компилятор</h2>
                    <pre><code>
    $ ls
    hello.py

    $ py5compile hello.py

    $ ls
    hello  hello.py
                    </code></pre>
                    <ul>
                        <li class="fragment">Нативный машинный код</li>
                        <li class="fragment">Скорость исполнения</li>
                    </ul>
                </section>

                <section>
                    <h2>Python 5?</h2>
                </section>

                <section data-markdown>
## Haskell

* Похож на Python
  * Отступы в 4 пробела
  * Переменная создаётся при первом присваивании
  * Необязательные аннотации типов
  * Иерархическая система модулей
                </section>

                <section data-markdown>
## Haskell

* Разделение изменяемого и неизменяемого
* Многострочные лямбды
* Статическая типизация
  * Автоматический вывод типов
  * Мощная система типов
* `runhaskell` для запуска через `#!` без явного создания бинарника
* Нет GIL!
                </section>

                <section data-markdown>
## Haskell

* Генерация кода из шаблонов со статической проверкой — shakespeare и другие библиотеки
* Вызов функций на С — встроено в язык (Foregn Function Interface)
* Вставка кода на С — библиотека inline-c
* ...
                </section>

                <section>
                    <h2>Контакты</h2>
                    <p>
                        Юрий Сыровецкий,<br>питонист
                    </p>
                    <p>
                        <a href="http://cblp.su">cblp.su</a>
                        &middot;
                        <a href="https://fb.me/cblp.su">fb.me/cblp.su</a>
                        &middot;
                        <a href="https://twitter.com/cblp_su">@cblp_su</a>
                    </p>
                </section>

            </div>

        </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.js"></script>

        <script>

            // Full list of configuration options available at:
            // https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                center: true,
                controls: false,
                history: true,
                progress: true,
                slideNumber: true,
                transition: 'fade', // none/fade/slide/convex/concave/zoom

                // Optional reveal.js plugins
                dependencies:
                  [ { src: 'lib/js/classList.js'
                    , condition: function() { return !document.body.classList; }
                    }
                  , { src: 'plugin/markdown/marked.js'
                    , condition: function() {
                          return !!document.querySelector( '[data-markdown]' );
                      }
                    }
                  , { src: 'plugin/markdown/markdown.js'
                    , condition: function() {
                          return !!document.querySelector( '[data-markdown]' );
                      }
                    }
                  , { src: 'plugin/highlight/highlight.js'
                    , async: true
                    , condition: function() {
                          return !!document.querySelector( 'pre code' );
                      }
                    , callback: function() {
                          hljs.configure({languages: ['haskell', 'python']});
                          hljs.initHighlightingOnLoad();
                      }
                    }
                  , { src: 'plugin/zoom-js/zoom.js', async: true }
                  , { src: 'plugin/notes/notes.js', async: true }
                  ]
            });

        </script>

    </body>
</html>
