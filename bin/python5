#!/bin/bash
set -eu
set -o pipefail

if [[ ! -z "${PYTHON5_LOCALTEST:-}" ]]; then
    if [[ -d .cabal-sandbox ]]; then
        package_db_opt="-package-db=$(echo .cabal-sandbox/*-ghc-*-packages.conf.d)"
    else
        package_db_opt="-package-db=dist/package.conf.inplace"
    fi
fi

exts="-XExtendedDefaultRules -XNoImplicitPrelude -XScopedTypeVariables"
opts="$exts ${package_db_opt:-}"

runhaskell $opts "$@"
